/*--------------------------------------------------------------------------------------------------------------------*/

#include <math.h>
#include <stdio.h>

#include "../indi_base_internal.h"

/*--------------------------------------------------------------------------------------------------------------------*/

indi_number_t *indi_number_new()
{
    /*----------------------------------------------------------------------------------------------------------------*/

    indi_number_t *obj = indi_memory_alloc(sizeof(indi_number_t));

    /*----------------------------------------------------------------------------------------------------------------*/

    obj->base = INDI_OBJECT(INDI_TYPE_NUMBER);

    /*----------------------------------------------------------------------------------------------------------------*/

    obj->value = 0.0;

    /*----------------------------------------------------------------------------------------------------------------*/

    return obj;
}

/*--------------------------------------------------------------------------------------------------------------------*/

void indi_number_free(indi_number_t *obj)
{
    obj->value = 0.0;

    indi_memory_free(obj);
}

/*--------------------------------------------------------------------------------------------------------------------*/

double indi_number_get(const indi_number_t *obj)
{
    return obj->value;
}

/*--------------------------------------------------------------------------------------------------------------------*/

void indi_number_set(indi_number_t *obj, double value)
{
    if(isnan(value))
    {
        fprintf(stderr, "NaN number not allowed in `indi_number_set`\n");
        fflush(stderr);
        return;
    }

    if(obj->value != value)
    {
        obj->value = value;

        indi_object_notify(&obj->base);
    }
}

/*--------------------------------------------------------------------------------------------------------------------*/

str_t indi_number_to_string(const indi_number_t *obj)
{
    return indi_double_dup(obj->value);
}

/*--------------------------------------------------------------------------------------------------------------------*/
